apiVersion: v1
kind: Service
metadata:
  name: redis-failover-controller
  namespace: redis-failover-lab
  labels:
    app.kubernetes.io/name: redis-failover-controller
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: lettuce-redis-failover-lab
spec:
  type: ClusterIP
  selector:
    app.kubernetes.io/name: redis-failover-controller
  ports:
    - name: http
      port: 8080
      targetPort: 8080
      protocol: TCP

---
# Redis endpoint ConfigMap - to be updated after infrastructure deployment
apiVersion: v1
kind: ConfigMap
metadata:
  name: redis-endpoint
  namespace: redis-failover-lab
  labels:
    app.kubernetes.io/name: redis-endpoint
    app.kubernetes.io/part-of: lettuce-redis-failover-lab
data:
  # Update these values after running `pulumi up`
  REDIS_CLUSTER_ENDPOINT: "redis-failover-lab.xxxxxx.clustercfg.use1.cache.amazonaws.com:6379"
  ELASTICACHE_REPLICATION_GROUP_ID: "redis-failover-lab"
